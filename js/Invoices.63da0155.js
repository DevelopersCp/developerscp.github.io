(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["Invoices"],{"51b0":function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("nav-bar",{attrs:{name:t.title}}),n("v-container",{staticClass:"text-center"},[t.isStaff?n("router-link",{attrs:{to:"/addinvoice"}},[n("v-btn",{staticClass:"mr-2 mb-2",attrs:{color:"#E47911",large:"",height:"40px",dark:""}},[n("v-icon",{attrs:{left:"",dark:""}},[t._v(" mdi-plus ")]),t._v(" Add invoice ")],1)],1):t._e(),t.isStaff?n("router-link",{attrs:{to:"/addextrainvoice"}},[n("v-btn",{staticClass:"mb-2",attrs:{color:"#E47911",large:"",height:"40px",dark:""}},[n("v-icon",{attrs:{left:"",dark:""}},[t._v(" mdi-plus ")]),t._v(" Add extra invoice ")],1)],1):t._e()],1),n("v-card",{staticClass:"ma-auto pb-5",attrs:{width:"90%",outlined:""}},[n("v-container",{staticClass:"text-center"},[n("v-card",[n("v-layout",[t.isStaff?n("v-col",{staticClass:"text-right",attrs:{cols:"10"}},[n("v-btn",{staticClass:"mr-1",attrs:{icon:"",right:""},on:{click:t.activeExport}},[n("v-icon",{attrs:{size:"24px",color:t.export_btn_color}},[t._v(" mdi-file-move ")])],1)],1):t._e(),t.isStaff?n("v-col",{staticClass:"text-right",attrs:{cols:"2"}},[n("v-btn",{staticClass:"mr-1",attrs:{icon:"",right:""},on:{click:t.activeDelete}},[n("v-icon",{attrs:{size:"24px",color:t.delete_btn_color}},[t._v(" mdi-delete ")])],1)],1):t._e()],1),n("v-card-title",[n("v-text-field",{attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),n("v-data-table",{attrs:{headers:t.headers,search:t.search,items:t.invoices,loading:t.loading,"loading-text":"Loading... Please wait","hide-default-footer":"",page:t.page,"items-per-page":t.itemsPerPage},on:{"update:page":function(e){t.page=e},"page-count":function(e){t.pageCount=e}},scopedSlots:t._u([{key:"item.status",fn:function(e){var i=e.item;return[n("v-chip",{attrs:{color:t.getColor(i.status),dark:""}},[t._v(" "+t._s(t._f("name_status")(i.status))+" ")])]}},{key:"item.unique_id",fn:function(e){var i=e.item;return[t.select?n("v-menu",{attrs:{top:"","offset-x":""},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on,a=e.attrs;return[n("v-btn",t._g(t._b({attrs:{icon:"",dark:""}},"v-btn",a,!1),i),[n("v-icon",{staticClass:"mb-2",attrs:{right:"",color:"#E47911",size:"26px"}},[t._v(" mdi-arrow-down-drop-circle ")])],1)]}}],null,!0)},[n("v-list",[t.isStaff?n("v-list-item",{attrs:{link:""}},[n("v-list-item-title",[n("router-link",{attrs:{to:{name:"UpdateInvoice",params:{id:i.unique_id}}}},[t._v(" Update invoice ")])],1)],1):t._e(),n("v-list-item",{attrs:{link:""},on:{click:function(e){return t.download_invoice(i.unique_id)}}},[n("v-list-item-title",[t._v(" Download invoice ")])],1)],1)],1):n("v-checkbox",{staticClass:"my-n3",attrs:{value:i.unique_id,color:"#E47911"},model:{value:t.idInvoice,callback:function(e){t.idInvoice=e},expression:"idInvoice"}})]}}])})],1),n("br"),n("v-pagination",{attrs:{length:t.pageCount},model:{value:t.page,callback:function(e){t.page=e},expression:"page"}}),t.select?t._e():n("v-row",[n("v-col",[n("v-btn",{staticClass:"mx-4 my-2",attrs:{color:"#989898",dark:""},on:{click:t.desactivarBtn}},[t._v(" CANCEL ")]),t.change?n("v-btn",{staticClass:"mx-4 my-2",attrs:{color:"#E47911",dark:"",loading:t.loading_exp},on:{click:t.export_invoices}},[t._v(" EXPORT ")]):t._e(),t.change?t._e():n("v-btn",{staticClass:"mx-4 my-2",attrs:{color:"#E47911",dark:"",loading:t.loading_del},on:{click:t.delete_invoices}},[t._v(" DELETE ")])],1)],1)],1)],1),n("footer-nav")],1)},a=[],o=(n("4160"),n("4fad"),n("d3b7"),n("3ca3"),n("159b"),n("ddb0"),n("2b3d"),n("3835")),r=n("d000"),c=n("fd2d"),s=n("af74"),l=n("3d20"),d=n.n(l),u={components:{NavBar:r["a"],FooterNav:c["a"]},data:function(){return{title:"INVOICES",select:!0,change:!0,export_btn_color:"#000",delete_btn_color:"#000",loading:!0,loading_exp:!1,loading_del:!1,page:1,pageCount:0,itemsPerPage:5,search:"",invoices:[],idInvoice:[],headers:[{text:"Name",value:"store.name"},{text:"Amount",value:"amount"},{text:"Status",value:"status"},{text:"Date",value:"due_date"},{text:"Actions",value:"unique_id",sortable:!1,search:!1}]}},computed:{isStaff:function(){return!!this.$store.state.auth.user.is_staff},idStore:function(){return this.isStaff?"":this.$store.state.auth.store_user.unique_id}},mounted:function(){this.refresh_list()},filters:{name_status:function(t){return"OK"==t?"Paid":"P"==t?"Pending":"Other"}},methods:{activeExport:function(){this.change=!0,this.select=!this.select,this.export_btn_color=this.select?"#000":"#E47911",this.delete_btn_color="#000"},activeDelete:function(){this.change=!1,this.select=!this.select,this.delete_btn_color=this.select?"#000":"#E47911",this.export_btn_color="#000"},desactivarBtn:function(){this.select=!this.select,this.export_btn_color="#000",this.delete_btn_color="#000"},refresh_list:function(){var t=this;this.loading=!0,this.isStaff?s["a"].list_admin().then((function(e){t.invoices=e,t.loading=!1})).catch((function(t){var e=t.response.data,n="";Object.entries(e).forEach((function(t){var e=Object(o["a"])(t,2),i=e[0],a=e[1];n+=i+": "+a+" \n "})),d.a.fire({icon:"error",title:"Error",text:n})})):s["a"].list_invoices(this.idStore).then((function(e){t.invoices=e,t.loading=!1})).catch((function(t){var e=t.response.data,n="";Object.entries(e).forEach((function(t){var e=Object(o["a"])(t,2),i=e[0],a=e[1];n+=i+": "+a+" \n "})),d.a.fire({icon:"error",title:"Error",text:n})}))},getColor:function(t){return"OK"==t?"green":"P"==t?"orange":"red"},delete_invoices:function(){var t=this;this.loading_del=!0,s["a"].delete_invoices(this.idInvoice).then((function(e){t.loading_del=!1,d.a.fire({icon:"success",title:"Success",text:e["message"]}).then((function(){t.refresh_list()}))})).catch((function(t){var e=t.response.data,n="";Object.entries(e).forEach((function(t){var e=Object(o["a"])(t,2),i=e[0],a=e[1];n+=i+": "+a+" \n "})),d.a.fire({icon:"error",title:"Error",text:n})}))},export_invoices:function(){var t=this;this.loading_exp=!0,s["a"].export_invoices(this.idInvoice).then((function(e){var n=window.URL.createObjectURL(new Blob([e.data])),i=document.createElement("a");i.href=n,i.setAttribute("download","invoices.xlsx"),document.body.appendChild(i),i.click(),t.loading_exp=!1})).catch((function(t){var e=t.response.data,n="";Object.entries(e).forEach((function(t){var e=Object(o["a"])(t,2),i=e[0],a=e[1];n+=i+": "+a+" \n "})),d.a.fire({icon:"error",title:"Error",text:n})}))},download_invoice:function(t){var e=this;d.a.fire({icon:"question",title:"Confirm",text:"Are you sure you want to download this invoice?",confirmButtonText:"YES",cancelButtonText:"NO",showCancelButton:!0}).then((function(n){n.isConfirmed&&s["a"].download_invoice(t).then((function(t){var n=window.URL.createObjectURL(new Blob([t])),i=document.createElement("a");i.href=n,i.setAttribute("download","invoice.pdf"),document.body.appendChild(i),i.click(),d.a.fire({icon:"success",title:"Success",text:"Invoice successfully download."}).then((function(){e.refresh_list()}))})).catch((function(t){var e=t.response.data,n="";Object.entries(e).forEach((function(t){var e=Object(o["a"])(t,2),i=e[0],a=e[1];n+=i+": "+a+" \n "})),d.a.fire({icon:"error",title:"Error",text:n})}))}))}}},v=u,f=n("2877"),h=Object(f["a"])(v,i,a,!1,null,null,null);e["default"]=h.exports},af74:function(t,e,n){"use strict";n("a4d3"),n("e01a");var i=n("d4ec"),a=n("bee2"),o=n("ab58"),r=(n("3d20"),function(){function t(){Object(i["a"])(this,t)}return Object(a["a"])(t,[{key:"list_admin",value:function(){return o["a"].get("admin/invoices/").then((function(t){return t.data}))}},{key:"list_invoices",value:function(t){return o["a"].get("invoice/".concat(t,"/store/")).then((function(t){return t.data}))}},{key:"list_pending",value:function(t){return o["a"].get("invoice/".concat(t,"/pending/")).then((function(t){return t.data}))}},{key:"add_invoice",value:function(t){var e=new FormData;return e.append("file",t.file),e.append("due_date",t.due_date),e.append("description",t.description),o["a"].post("admin/invoices/",e,{headers:{"content-type":"multipart/form-data"}}).then((function(t){return t.data}))}},{key:"add_extra",value:function(t){return o["a"].post("admin/invoices/create_invoices/",{amount:t.amount,due_date:t.due_date,description:t.description,id_stores:t.id_stores}).then((function(t){return t.data}))}},{key:"delete_invoices",value:function(t){return o["a"].post("admin/invoices/remove_invoices/",{id_invoices:t}).then((function(t){return t.data}))}},{key:"export_invoices",value:function(t){return o["a"].post("admin/invoices/export_invoices/",{id_invoices:t},{responseType:"blob"}).then((function(t){return t}))}},{key:"update",value:function(t,e){return o["a"].put("admin/invoices/"+e+"/",{amount:t.amount,due_date:t.due_date,description:t.description,status:t.status,store:t.store}).then((function(t){return t.data}))}},{key:"get",value:function(t){return o["a"].get("admin/invoices/"+t+"/").then((function(t){return t.data}))}},{key:"download_invoice",value:function(t){return o["a"].get("invoice/"+t+"/download_invoice",{responseType:"blob"}).then((function(t){return t.data}))}}]),t}());e["a"]=new r}}]);
//# sourceMappingURL=Invoices.63da0155.js.map